---
title: "Семинар 2. Работа с таблицами."
author: "Алла Тамбовцева"
output: html_document
---

## Часть 1

1. Поставьте библиотеку [randomNames](https://cran.r-project.org/web/packages/randomNames/randomNames.pdf). Обратитесь к ней через `library()`.

2. Создайте вектор из 100 испанских имен:

```{r, eval=FALSE}
set.seed(1234) # чтобы у всех получались одинаковые результаты
names <- randomNames(100, which.names = "first", ethnicity = 4)
```

3. Будем считать, что эти 100 имен – имена опрошенных респондентов. Создайте вектор со значениями возраста респондентов:

```{r, eval=FALSE}
ages <- sample(16:75, 100, replace = TRUE) # replace = TRUE - с повторяющимися значениями
```

А также вектор `polit` – политические взгляды респондентов:

```{r}
views <- c("right", "left", "moderate", "indifferent")
polit <- sample(views, 100, replace = TRUE)
```

Создайте из полученных трёх векторов датафрейм.

4. Создайте столбец `id` с номерами респондентов.

5. Определите, сколько среди респондентов людей в возрасте от 25 до 30 лет (включительно). Определите, какую долю респондентов в нашей сымпровизированной выборке составляют люди в возрасте от 25 до 30 лет. Выразите эту долю в процентах, округлите ее до 1 знака после запятой.

6. Создайте «факторный» вектор политических взглядов `polit_views`. Сколько у полученного фактора уровней? Добавьте в датафрейм столбец `polit_views`.

## Часть 2

1. Загрузите файл `Firms.csv`. Почитать про базу можно [здесь](https://www.rdocumentation.org/packages/car/versions/2.1-5/topics/Ornstein). Посмотрите на таблицу.

2. Сколько в датафрейме наблюдений? Сколько переменных? Какие это переменные?

3. Сколько в датафрейме полностью заполненных строк (наблюдений)? Выведите (если такие есть) наблюдения, содержащие пропущенные значения на экран.

4. Отфильтруйте наблюдения в таблице согласно следующим критериям:

    * фирмы с активами от 10000 до 20000 (включительно);

    * фирмы, число управляющих позиций, совместных с другими фирмами, которых не превышает 30;

    * фирмы транспортного сектора (`TRN`) под руководством управляющих из Канады (`CAN`);

5. Создате переменную «натуральный логарифм активов» (`log_assets`) и добавьте её в датафрейм.

6. Постройте график, который может проиллюстрировать, какие паттерны пропущенных наблюдений можно зафиксировать в таблице.

7. Удалите пропущенные значения из базы данных.

8. Сохраните измененную базу данных в формате Stata (файл `“Firms.dta”`)